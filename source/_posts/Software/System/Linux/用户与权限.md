---
title: Linux 用户与权限
categories:
- Software
- System
- Linux
---
# Linux 用户与权限

- Linux系统是一个多用户多任务的分时操作系统,任何一个要使用系统资源的用户,都必须首先向系统管理员申请一个账号,然后以这个账号的身份进入系统
- 用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪,并控制他们对系统资源的访问;另 一方面也可以帮助用户组织文件,并为用户提供安全性保护
- 每个用户账号都拥有一个唯一的用户名和各自的口令, 用户在登录时键入正确的用户名和口令后,就能够进入系统和自己的主目录, 实现用户账号的管理,要完成的工作主要有如下几个方面:
    - 用户账号的添加
    - 删除与修改
    - 用户口令的管理
    - 用户组的管理

## 用户账号的管理

```
用户名@主机名:目录(#|$)
```

- \#表示是具有root权限的用户
- $表示不具有root权限的用户

### who

```
who - [husfV] [user]
```

- -H 或 --heading:显示各栏位的标题信息列
- -i 或 -u 或 --idle:显示闲置时间,若该用户在前一分钟之内有进行任何动作,将标示成"."号,如果该用户已超过24小时没有任何动作,则标示出"old"字符串
- -m:此参数的效果和指定"am i"字符串相同
- -q 或--count:只显示登入系统的帐号名称和总人数
- -s:此参数将忽略不予处理,仅负责解决who指令其他版本的兼容性问题
- -w 或-T或--mesg或--message或--writable:显示用户的信息状态栏
- --help:在线帮助
- --version:显示版本信息

**实例**

- 显示当前登录系统的用户

```shell
who
root   tty7     2014-05-13 12:12 (:0)
root   pts/0    2014-05-14 17:09 (:0.0)
root   pts/1    2014-05-14 18:51 (192.168.1.17)
root   pts/2    2014-05-14 19:48 (192.168.1.17)
```

### useradd

```shell
useradd -选项 用户名
-c comment #comment指定一段注释性描述
-d 目录 #指定用户瞩目哭,如果此目录不存在,则同时使用-m选项,可以创建主目录
-m #自动创建这个用户的主目录/home/用户名
-g 用户组 #指定用户所属的用户组
-G 用户组 #指定用户所属的附加组
-s shell文件 #指定用户的登录shell
-u 用户号 #指定用户的用户号,如果同时有-o选项,则可以重复使用其他用户的标识号
```

Linux中一切皆文件,这里的添加用户说就是往`/etc/passwd`中写入用户的信息

### userdel

```shell
userdel -选项 用户名
-r 用户名 #删除用户的时候将他的目录页一并删掉!
```

### usermod

```shell
usermod -选项 修改内容 用户名
-c comment #comment指定一段注释性描述
-d 目录 #指定用户瞩目哭,如果此目录不存在,则同时使用-m选项,可以创建主目录
-m #自动创建这个用户的主目录/home/用户名
-g 用户组 #指定用户所属的用户组
-G 用户组 用户组 #注定==指定用户所属的附加组
-s shell文件 #指定用户的登录shell
-u 用户号 #指定用户的用户号,如果同时有-o选项,则可以重复使用其他用户的标识号
```

### su

```shell
su 用户名 #切换用户
su -用户名 #如果想在切换用户之后使用新用户的工作环境,可以在su和username之间加-
```

### sudo

```shell
sudo 命令 # 以管理员的权限运行命令
sudo su #从普通用户切换到root用户
```

- `-i`:为了频繁的执行某些只有超级用户才能执行的权限,而不用每次输入密码,可以使用该命令,提示输入密码时该密码为当前账户的密码,没有时间限制,执行该命令后提示符变为"#”而不是"$”,想退回普通账户时可以执行"exit”或"logout”

### exit

- `exit`命令用于退出目前的shell
- 执行exit可使shell以指定的状态值退出,若不设置状态值参数,则shell以预设值退出,状态值0代表执行成功,其他值代表执行失败,exit也可用在script,离开正在执行的script,回到shell

```shell
exit #退回原来的用户,等同于<C-r>
```

### passwd

```shell
#root用户
passwd 用户名
new password: #输入密码
re password: #重新输入密码
#普通用户
passwd
(current) UNIX password:
new password:
re password:

# 锁定账户
passwd -l 用户名 #锁定之后这个用户不能登录
passwd -d 用户名 #没有密码也不能登录
```

### hostname

```shell
hostname #查看主机名
hostname 主机名 #修改主机名(临时修改)
```

## 用户组管理

每个用户都有一个用户组,系统可以对一个用户组中的所有用户进行集中管理(开发,测试,运维, root),不同Linux 系统对用户组的规定有所不同,如Linux下的用户属于与它同名的用户组,这个用户 组在创建用户时同时创建

用户组的管理涉及用户组的添加,删除和修改,组的增加,删除和修改实际上就是对`/etc/group`文件的更新

### groupadd

```shell
groupadd 组名 #创建完用户组后可以得到一个组的id,这个id是可以指定的
-g id #如果不指定就是自增1
```

### groupdel

```shell
groupdel 组名
```

### groupmod

```shell
groupmod -选项 修改内容 组名
-g id #修改组id
-n 新组名 #修改新组名
```

### newgrp

```shell
newgrp 组名
```

newgrp 指令类似 login 指令,它是以相同的帐号,另一个群组名称,再次登入系统,欲使用 newgrp 指令切换群组,您必须是该群组的用户,否则将无法登入指定的群组,单一用户要同时隶属多个群组,需利用交替用户的设置,若不指定群组名称,则 newgrp 指令会登入该用户名称的预设群组

### /etc/passwd

这个文件中的每一行都代表这一个用户

登录口令:把真正的加密后的用户口令字存放到`/etc/shadow`文件中

```shell
用户名:口令(登录密码x,不可见):用户标识号:组标识号:注释性描述:主目录:登录Shell

root:*:0:0:System Administrator:/var/root:/bin/sh
daemon:*:1:1:System Services:/var/root:/usr/bin/false
```

### /etc/group

```
组名:口令:组标识号:组内用户列表

wheel:*:0:root
daemon:*:1:root
kmem:*:2:root
sys:*:3:root
tty:*:4:root
operator:*:5:root
mail:*:6:_teamsserver
bin:*:7:
```

### /etc/shadow

```
登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志
```