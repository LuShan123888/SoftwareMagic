---
title: Linux 文件系统
categories:
- Software
- System
- Linux
---
# Linux 文件系统

## 系统目录结构

|    路径     |                             描述                             |
| :---------: | :----------------------------------------------------------: |
|    /bin     |      bin是Binary的缩写,,这个目录存放着最经常使用的命令       |
|    /boot    | 这里存放的是启动Linux时使用的一些核心文件,包括一些连接文件以及镜像文件 |
|    /dev     | dev是Device(设备)的缩写,,存放的是Linux的外部设备,在Linux中访问设备的方式和访问文件的方式是相同的 |
|    /etc     |    这个目录用来存放所有的系统管理所需要的配置文件和子目录    |
|    /home    | 用户的主目录,在Linux中,每个用户都有一个自己的目录,一般该目录名是以用户的账号命名的 |
|    /lib     | 这个目录里存放着系统最基本的动态连接共享库,其作用类似于Windows里的DLL文件 |
| /lost+found | 这个目录一般情况下是空的,当系统非法关机后,这里就存放了一些文件,(存放,突然关机的一些文件) |
|   /media    | linux系统会自动识别一些设备,例如U盘,光驱等等,当识别后,linux会把识别的设备,挂载到这个目录下 |
|    /mnt     | 系统提供该目录是为了让用户临时挂载别的文件系统的,我们可以将光驱挂载在/mnt/上,,然后进入该目录就可以查看光驱里的内容了 |
|    /opt     | 这是给主机额外安装软件所摆放的目录,比如你安装一个ORACLE数据库则就可以放到这个,目录下,默认是空的 |
|    /proc    | 这个目录是一个虚拟的目录,它是系统内存的映射,我们可以通过直接访问这个目录来获取系统信息 |
|    /root    |       该目录为系统管理员,也称作超级权限者的用户主目录        |
|    /sbin    | s就是Super,User的意思,这里存放的是系统管理员使用的系统管理程序 |
|    /srv     |           该目录存放一些服务启动之后需要提取的数据           |
|    /sys     | 这是linux2.6内核的一个很大的变化,该目录下安装了2.6内核中新出现的一个文件系统,sysfs |
|    /tmp     | 这个目录是用来存放一些临时文件的,用完即丢的文件,可以放在这个目录下,安装包 |
|    /usr     | 这是一个非常重要的目录,用户的很多应用程序和文件都放在这个目录下,类似于windows,下的programfiles目录 |
|  /usr/bin   |                    系统用户使用的应用程序                    |
|  /usr/sbin  |     超级用户使用的比较高级的管理程序和系统守护程序,Super     |
|  /usr/src   |                   内核源代码默认的放置目录                   |
|    /var     | 这个目录中存放着在不断扩充着的东西,我们习惯将那些经常被修改的目录放在这个目录,下,包括各种日志文件 |
|    /run     | 是一个临时文件系统,存储系统启动以来的信息,当系统重启时,这个目录下的文件应该被,删掉或清除 |
|    /www     |           存放服务器网站相关的资源,环境,网站的项目           |

## 目录管理

### cd

```shell
cd 路径 #切换目录命令
cd ./  #当前目录
cd ../ #返回上一级目录
cd ~ #用户目录
cd / #根路径
```

### ls

```shell
ls
-s #文件大小
-a #all,查看全部的文件,包括隐藏文件
-l #列表显示,包含文件的属性和权限,没有隐藏文件
-k #以k字节的形式表示文件的大小
# 可以组合使用
ls -al #显示所有文件的详细信息
ls -sk #以K字节为单位显示文件大小
ls -l #ll
```

### pwd

```shell
pwd #显示当前的路径(绝对路径)
```

### mkdir

```shell
mkdir test1 #创建目录
mkdir -p test2/test3/test4 #创建多级目录
```

### rmdir

- rmdir 仅能删除空的目录,如果下面存在文件,需要先删除文件

```shell
rmdir test1 #删除目录
```

- `-p`:当子目录被删除后使它也成为空目录的话，则顺便一并删除


```shell
rmdir -p BBB/Test
```

- 在工作目录下的 BBB 目录中，删除名为 Test 的子目录。若 Test 删除后，BBB 目录成为空目录，则 BBB 亦予删除。

### cp

```shell
cp [options] source dest
或
cp [options] source... directory
```

- -a:此选项通常在复制目录时使用,它保留链接,文件属性,并复制目录下的所有内容,其作用等于dpR参数组合
- -d:复制时保留链接,这里所说的链接相当于Windows系统中的快捷方式
- -f:覆盖已经存在的目标文件而不给出提示
- -i:与-f选项相反,在覆盖目标文件之前给出提示,要求用户确认是否覆盖,回答"y"时目标文件将被覆盖
- -p:除复制文件的内容外,还把修改时间和访问权限也复制到新文件中
- -r:若给出的源文件是一个目录文件,此时将复制该目录下所有的子目录和文件
- -l:不复制文件,只是生成链接文件

**实例**

```shell
cp -ri ./* ../
```

- 将当前目录下的所有文件复制到上层目录中

### rm

- 删除一个文件或者目录

```shell
rm [options] name...
```

- -i:删除前逐一询问确认
- -f:即使原档案属性设为唯读,亦直接删除,无需逐一确认
- -r:将目录及以下之档案亦逐一删除

### mv

- 移动文件或者目录,重命名文件

```shell
mv (原路径)/原文件名 (新路径)/新文件名
-f 强制
-u 只替换已经更新过的文件
```

### touch

- 创建文件

```shell
touch ~/1.txt
```

### echo

- 输入字符串,也可以输入到文件中
- `>>`将前面的输出追加到后面文件的尾部

```shell
echo '字符串' >> 路径名/文件名
```

## 查找文件

### which

- Linux which命令用于查找文件。
- which指令会在环境变量$PATH设置的目录里查找符合条件的文件。

```
which [文件...]
```

- `-n<文件名长度> `:指定文件名长度，指定的长度必须大于或等于所有文件中最长的文件名。
- `-p<文件名长度>`:与-n参数相同，但此处的<文件名长度>包括了文件的路径。
- `-w`:指定输出时栏位的宽度。

### whereis

- Linux whereis命令用于查找文件
- 该指令会在特定目录中查找符合条件的文件,这些文件应属于原始代码,二进制文件,或是帮助文件
- 该指令只能用于查找二进制文件,源代码文件和man手册页,一般文件的定位需使用locate命令

```
whereis [-bfmsu][-B <目录>...][-M <目录>...][-S <目录>...][文件...]
```

**参数**:

- `-b` 　只查找二进制文件
- `-B<目录>` 　只在设置的目录下查找二进制文件
- `-f` 　不显示文件名前的路径名称
- `-m` 　只查找说明文件
- `-M<目录>` 　只在设置的目录下查找说明文件
- `-s` 　只查找原始代码文件
- `-S<目录>` 　只在设置的目录下查找原始代码文件
- `-u` 　查找不包含指定类型的文件

**实例**

- 使用指令"whereis"查看指令"bash"的位置,输入如下命令:

```
$ whereis bash
```

- 上面的指令执行后,输出信息如下所示:

```
bash:/bin/bash/etc/bash.bashrc/usr/share/man/man1/bash.1.gz
```

- **注意**:以上输出信息从左至右分别为查询的程序名,bash路径,bash的man 手册页路径
- 如果用户需要单独查询二进制文件或帮助文件,可使用如下命令:

```
$ whereis -b bash
$ whereis -m bash
```

- 输出信息如下:

```
$ whereis -b bash               #显示bash 命令的二进制程序
bash: /bin/bash /etc/bash.bashrc /usr/share/bash    # bash命令的二进制程序的地址
$ whereis -m bash               #显示bash 命令的帮助文件
bash: /usr/share/man/man1/bash.1.gz  #bash命令的帮助文件地址
```

## 文件属性

```shell
➜  ~ ll
total 264
drwx------@   3 cian  staff    96B Mar 13 17:38 Applications
drwxr-xr-x@   7 cian  staff   224B Jul 28 15:49 Code
drwx------@   9 cian  staff   288B Jul 29 14:06 Desktop
drwx------@  12 cian  staff   384B Jul 29 22:29 Documents
drwx------+   7 cian  staff   224B Jul 29 20:18 Downloads
drwx------@  75 cian  staff   2.3K Jun 12 10:19 Library
drwx------+   8 cian  staff   256B Jun  2 08:35 Movies
drwx------+   7 cian  staff   224B Mar 14 10:24 Music
drwx------+   7 cian  staff   224B Jun  5 13:26 Pictures
drwxr-x---+   5 cian  staff   160B Jul  9 11:04 Public
drwxr-xr-x    7 cian  staff   224B Jun 19 00:08 Virtual Machines.localized
drwx------   11 cian  staff   352B May  2 16:01 iCloud Drive (Archive)
drwxr-xr-x  305 cian  staff   9.5K Jul 11 20:19 node_modules
-rw-r--r--@   1 cian  staff   129K Jul 11 20:19 package-lock.json
```

- 在Linux中第一个字符代表这个文件是目录,文件或链接文件等等:
  - 当为[ **d** ]则是目录
  - 当为[ **-** ]则是文件
  - 若是[ **l** ]则表示为链接文档 ( link file )
  - 若是[ **b** ]则表示为装置文件里面的可供储存的接口设备 ( 可随机存取装置 )
  - 若是[ **c** ]则表示为装置文件里面的串行端口设备,例如键盘,鼠标 ( 一次性读取装置 )
- 接下来的字符中,以三个为一组,且均为『rwx』 的三个参数的组合
  - [ r ]代表可读(read)
  - [ w ]代表可写(write)
  - [ x ]代表可执行(execute)
  - [ - ]无权限
- 每个文件的属性由左边第一部分的10个字符来确定(如下图):

![image-20200729223243490](https://raw.githubusercontent.com/LuShan123888/Files/main/Pictures/2020-12-10-vZfXuBbAkPIRg2J.png)

- 从左至右用0-9这些数字来表示
  - 第0位确定文件类型
  - 第1-3位确定属主(该文件的所有者)拥有该文件的权限
  - 第4-6位确定属组(所有者的同组用户)拥有该文件的权限
  - 第7-9位确定其他用户拥有该文件的权限
- 其中
  - 第1,4,7位表示读权限,如果用"r"字符表示,则有读权限,如果用"-"字符表示,则没有读权限
  - 第2,5,8位表示写权限,如果用"w"字符表示,则有写权限,如果用"-"字符表示没有写权限
  - 第3,6,9位表示可执行权限,如果用"x"字符表示,则有执行权限,如果用"-"字符表示,则没有执行权限
- 对于文件来说,它都有一个特定的所有者,也就是对该文件具有所有权的用户, 同时,在Linux系统中,用户是按组分类的,一个用户属于一个或多个组, 文件所有者以外的用户又可以分为文件所有者的同组用户和其他用户,因此,Linux系统按文件所有者,文件所有者同组用户和其他用户来规定了不同的文件访问权限
- 在以上实例中,属主为cian和属组为staff

### chgrp

- 更改文件属组

```shell
chgrp [-R] 属组名 文件名
-R #递归更改文件属组
```

### chown

- 更改文件属主,也可以同时更改文件属组

```shell
chown [–R] 属主名 文件名
chown [-R] 属主名:属组名 文件名
```

- -c 显示更改的部分的信息
- -f 忽略错误信息
- -h 修复符号链接
- -R 处理指定目录以及其子目录下的所有文件
- -v 显示详细的处理信息
- -deference 作用于符号链接的指向,而不是链接文件本身

### chmod

- `chmod [-R] xyz`文件或目录 Linux文件属性有两种设置方法,一种是数字(常用的是数字),一种是符号
- Linux文件的基本权限就有九个,分别是owner/group/others三种身份各有自己的read/write/execute 权限

```shell
r:4 w:2 x:1
可读可写不可执行 rw- 6
可读可写不课执行 rwx 7
chomd 777 文件赋予所有用户可读可执行!
```

- 每种身份(owner/group/others)各自的三个权限(r/w/x)分数是需要累加的,例如当权限为:[-rwxrwx---] 分数则是:

```shell
owner = rwx = 4+2+1 = 7
group = rwx = 4+2+1 = 7
others= --- = 0+0+0 = 0
chmod 770 filename
```

- u 表示该文件的拥有者,g 表示与该文件的拥有者属于同一个群体(group)者,o 表示其他以外的人,a 表示这三者皆是
- \+ 表示增加权限,- 表示取消权限,= 表示唯一设定权限
- r 表示可读取,w 表示可写入,x 表示可执行,X 表示只有当该文件是个子目录或者该文件已经被设定过为可执行
- -c : 若该文件权限确实已经更改,才显示其更改动作
- -f : 若该文件权限无法被更改也不要显示错误讯息
- -v : 显示权限变更的详细资料
- -R : 对目前目录下的所有文件与子目录进行相同的权限变更(即以递归的方式逐个变更)
- --help : 显示辅助说明
- --version : 显示版本

## 文件内容

### cat

- 由第一行开始显示文件内容

### tac

-  从最后一行开始显示,可以看出 tac 是 cat 的倒着写

### nl

-  显示的时候输出行号

### more

- 一页一页的显示文件内容
- 空格代表翻页
- `enter` 代表向下看一行
- ` :f` 查看行号

### less

- 空格下翻页
- `pageDown`,`pageUp`键代表翻动页面
- `q`退出
- 查找字符串
    - `/` 向下查询
    - `?` 向上查询
- 要查询的字符串
    - `n` 继续搜寻下一个
    - `N` 上寻找

### head

- 查看文件前几行
- `-n`:控制显示的行数

### tail

- 查看文件后几行
- `-n`"控制显示的行数

### wc

- 利用wc指令我们可以计算文件的Byte数、字数、或是列数，若不指定文件名称、或是所给予的文件名为"-"，则wc指令会从标准输入设备读取数据。

```
wc [-clw][--help][--version][文件...]
```

- `-c,--bytes,--chars`:只显示Bytes数。
- `-l,--lines`:显示行数。
- `-w,--words`:只显示字数。

### grep

- Linux grep 命令用于查找文件里符合条件的字符串

```shell
grep [正则表达式] [文件或目录...]
```

- **-v 或 --invert-match** : 显示不包含匹配文本的所有行

## 文件解压

- Linux下常见的压缩包格式有5种:
    - zip
    - tar.gz
    - tar.bz2
    - tar.xz
    - tar.Z
- 其中tar是种打包格式,gz和bz2等后缀才是指代压缩方式:gzip和bzip2

### zip

```
unzip filename.zip
```

### tar.gz

```
tar -zxvf filename.tar.gz -C ~/tar
```

- 其中zxvf含义分别如下
    - z: g**z**ip压缩格式
    - x: e**x**tract 解压
    - v: **v**erbose详细信息
    - f**:f**ile(file=archieve)文件
    - -C: 建立压缩档案,解压到指定目录下

### tar.bz2

```
tar -jxvf filename.tar.bz2
```

- j: bzip2压缩格式
- 其它选项和tar.gz解压含义相同

### tar.xz

```
tar -Jxvf filename.tar.xz
```

- 注意J大写

### tar.Z

```
tar -Zxvf filename.tar.Z
```

- 注意Z大写

### tar

- 关于tar的详细命令可以

```
tar --help
```

- **事实上, 从1.15版本开始tar就可以自动识别压缩的格式,故不需人为区分压缩格式就能正确解压**

```
tar -xvf filename.tar.gz
tar -xvf filename.tar.bz2
tar -xvf filename.tar.xz
tar -xvf filename.tar.Z
```

## 传输文件

### sftp

#### 登陆

```shell
sftp user@ip
```

#### 帮助

```shell
help
```

建立连接后, linux shell中的$编程了sftp>,  这也对, 现在执行以下help, 可以看看sftp支持哪些命令

#### 查看当前目录的路径

```shell
pwd
lpwd
```

pwd是看远端服务器的目录, 即sftp服务器默认的当前目录,  lpwd是查看本地目录

#### 查看当前目录的文件

```shell
ls
lls
```

ls是看sftp服务器下当前目录下的东东, lls是查看本地当前目录下

#### 上传

```shell
put a.txt
```

把linux本地目录下的a.txt文件上传到sftp服务器的当前目录下

#### 下载

```shell
get b.txt
```

把sftp服务器当前目录下的b.txt文件下载到本地当前目录下

#### 本地执行

```shell
!command
```

- 这个是指在本地上执行command这个命令, 比如!ls是列举本地当前目录下的东东, !rm a.txt是删除本地当前目录下的a.txt文件
- 这个命令非常非常有用, 因为在sftp> 后输入命令, 默认值针对sftp服务器的, 所以执行rm a.txt删除的是sftp服务器上的a.txt文件, 而非本地的linux上的a.txt文件

#### 退出

```shell
exit
quit
```

### scp

- Linux scp 命令用于 Linux 之间复制文件和目录
- scp 是 secure copy 的缩写, scp 是 linux 系统下基于 ssh 登陆进行安全的远程文件拷贝命令
- scp 是加密的,rcp是不加密的,scp 是 rcp 的加强版

#### 语法

```bash
scp [-1246BCpqrv] [-c cipher] [-F ssh_config] [-i identity_file]
[-l limit] [-o ssh_option] [-P port] [-S program]
[[user@]host1:]file1 [...] [[user@]host2:]file2
```

简易写法:

```
scp [可选参数] file_source file_target
```

**参数说明**:

- -1:强制scp命令使用协议ssh1
- -2:强制scp命令使用协议ssh2
- -4:强制scp命令只使用IPv4寻址
- -6:强制scp命令只使用IPv6寻址
- -B:使用批处理模式(传输过程中不询问传输口令或短语)
- -C:允许压缩,(将-C标志传递给ssh,从而打开压缩功能)
- -p:保留原文件的修改时间,访问时间和访问权限
- -q:不显示传输进度条
- -r:递归复制整个目录
- -v:详细方式显示输出,scp和ssh会显示出整个过程的调试信息,这些信息用于调试连接,验证和配置问题
- -c cipher:以cipher将数据传输进行加密,这个选项将直接传递给ssh
- -F ssh_config:指定一个替代的ssh配置文件,此参数直接传递给ssh
- -i identity_file:从指定文件中读取传输时使用的密钥文件,此参数直接传递给ssh
- -l limit:限定用户所能使用的带宽,以Kbit/s为单位
- -o ssh_option:如果习惯于使用ssh_config中的参数传递方式
- -P port:注意是大写的P, port是指定数据传输用到的端口号
- -S program:指定加密传输时所使用的程序,此程序必须能够理解ssh的选项

#### 复制文件

```shell
scp local_file remote_username@remote_ip:remote_folder
# OR
scp local_file remote_username@remote_ip:remote_file
# OR
scp local_file remote_ip:remote_folder
# OR
scp local_file remote_ip:remote_file
```

- 第1,2个指定了用户名,命令执行后需要再输入密码,第1个仅指定了远程的目录,文件名字不变,第2个指定了文件名
- 第3,4个没有指定用户名,命令执行后需要输入用户名和密码,第3个仅指定了远程的目录,文件名字不变,第4个指定了文件名

**实例**

```shell
scp /home/space/music/1.mp3 root@www.runoob.com:/home/root/others/music
scp /home/space/music/1.mp3 root@www.runoob.com:/home/root/others/music/001.mp3
scp /home/space/music/1.mp3 www.runoob.com:/home/root/others/music
scp /home/space/music/1.mp3 www.runoob.com:/home/root/others/music/001.mp3
```

#### 复制目录

```shell
scp -r local_folder remote_username@remote_ip:remote_folder
# OR
scp -r local_folder remote_ip:remote_folder
```

- 第1个指定了用户名,命令执行后需要再输入密码
- 第2个没有指定用户名,命令执行后需要输入用户名和密码

**实例**

```
scp -r /home/space/music/ root@www.runoob.com:/home/root/others/
scp -r /home/space/music/ www.runoob.com:/home/root/others/
```

- 上面命令将本地 music 目录复制到远程 others 目录下

#### 说明

- 从远程复制到本地,只要将从本地复制到远程的命令的后2个参数调换顺序即可
- 如果远程服务器防火墙有为scp命令设置了指定的端口,我们需要使用 -P 参数来设置命令的端口号,命令格式如下:

```shell
#scp 命令使用端口号 4588
scp -P 4588 remote@www.runoob.com:/usr/local/sin.sh /home/administrator
```

- 使用scp命令要确保使用的用户具有可读取远程服务器相应文件的权限,否则scp命令是无法起作用的

## 链接

**硬链接**

- A---B,假设B是A的硬链接,那么他们两个指向了同一个文件,即允许一个文件拥有多个路径,用户可以通过这种机制建立硬链接到一些重要文件上,防止误删

**软链接**

- 类似Window下的快捷方式,删除的源文件,快捷方式也访问不了

### ln命令

**创建一个硬链接**

```shell
ln <sourceDir> f1
```

删除源文件之后,f1仍然可以正常访问

**创建一个软链接(符号连接)**

```shell
ln -s <sourceDir> f2
```

删除源文件之后,f2不能被访问

## 磁盘管理

### df

列出文件系统整体的磁盘使用量

```shell
df
/dev/disk1s1                                      373871240 239508040  105521744    70%   1710292 1867645908    0%   /System/Volumes/Data

-h #进制换算
```

### du

检查当前目录空间的使用量

```shell
du
248	./.config/ranger
24	./.config/configstore
7944	./.config/clash
104	./.config/filezilla
8344	./.config

-a #包括隐藏文件
-h #进制换算
-sm #查看本目录所占用的容量
-sm 目录 #查看指定目录所占的容量
-sm 目录/* #查看指定目录下的所有目录所占的容量
```

### mount

 挂载本地磁盘或者文件

```shell
mount 外部设备路径 目标目录
mount /dev/usb /mnt/usb
```

### unmount

卸载本地磁盘或者文件

```shell
umount 挂载位置
-f #
```